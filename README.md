# bluues_cplx
Electrostatic properties of molecular complexes

** FILES CONTAINED IN THIS REPOSITORY **

The files and the instructions provided in this directory should be sufficient to install the program.

- README.md - the file you are reading
- bluues_cplx.c - this is the program
- test/ - a directory containing the file pdb1ay7.pqr 
- test.orig.zip - which is a zip of the directory containing the file pdb1ay7.pqr and the output files obtained by running the commands:
> bluues_cplx  pdb1ay7.pqr test_ns A B -ns test_ns_aux -srf -srfpot -pa 0.1
> bluues_cplx  pdb1ay7.pqr test_msm A B -m test_msms_aux -pa 0.1 -lite
or
> ./clean_and_run.sh
(see the description below)
- NanoShaper.mod - utility file for NanoShaper installation

** HOW TO INSTALL **

It is not mandatory, but it would be standard to unpack the file bluues_cplx.tgz in the directory /usr/local/src/
You should have permissions to do this.

1) Unpack the archive:

> tar xzvf bluues_cplx.tgz

2) go to the directory bluues_cplx

> cd bluues_cplx

3) get the surface generating program NanoShaper
4) 
> wget https://gitlab.iit.it/SDecherchi/nanoshaper/-/raw/Release-0.7.8/pkg_nanoshaper_0.7.8.tar.gz

> tar xzvf pkg_nanoshaper_0.7.8.tar.gz

(alternatively the surface generating program MSMS can be used:
> mkdir msms

> cd msms

> wget https://ccsb.scripps.edu/msms/download/933/msms_i86_64Linux2_2.6.1.tar.gz -nc

> tar zxvf msms_i86_64Linux2_2.6.1.tar.gz
> cd ..
)


3) compile bluues_cplx:
 
> cc bluues_cplx.c  -o bluues_cplx -lm -O3

4) make symbolic links to the executables to a directory which is in the PATH for commands,
typically this is /usr/local/bin/ (otherwise you must change /usr/local/bin to a directory which is in your PATH): 

> sudo ln -s $(pwd)/bluues_cplx /usr/local/bin/bluues_cplx 
> cp NanoShaper.mod  $(pwd)/pkg_nanoshaper_0.7.8/NanoShaper 
> sudo ln -s $(pwd)/pkg_nanoshaper_0.7.8/NanoShaper /usr/local/bin/NanoShaper 

(
if also msms has been downloaded:
> sudo ln -s $(pwd)/msms/msms.x86_64Linux2.2.6.1.staticgcc /usr/local/bin/msms 
)

** EXAMPLE USAGE **

The directory test contains a pqr file relative to a molecular complex of chain A and chain B.

A typical use of bluues_cplx would be the following:

> bluues_cplx  pdb1ay7.pqr test A B -ns test_ns -srf -srfpot 

(or the like with the option -lite to output only the summmary file:

> bluues_cplx  pdb1ay7.pqr test A B -ns test_ns -lite 
)

This will generate the output files:

- a summary file containing concise information on interfacial properties 
(energies, areas, correlations...)
- pqr files containing atoms within the cutoff from the interface for 
chain(s) A, chain(s) B and complex
test_int_mol_1.pqr  test_int_mol_2.pqr  test_int.pqr

- area per residues and atoms for chain(s) A, chain(s) B and complex
test_mol_1.area     test_mol_2.area	test.area

- for each patch of the surface, the contacting atom number, the coordinates 
of SES patch and normal vector for chain(s) A, chain(s) B and complex
test_mol_1.at_r_n   test_mol_2.at_r_n	test.at_r_n

- Generalized Born radii for atoms for chain(s) A, chain(s) B and complex
test_mol_1.gbr      test_mol_2.gbr	test.gbr

- total and per atom energy components for chain(s) A, chain(s) B and complex and their difference
test_mol_1.nrg      test_mol_2.nrg	test.nrg  test_diff.nrg

- pqr file with GB radius replacing van der Waals radius for chain(s) A, chain(s) B and complex
test_mol_1.pqg      test_mol_2.pqg	test.pqg

- interface surface points as pdb files, with the potential (kJ/(mol q)) in the
temperature factor field for chain(s) A and chain(s) B
test_mol_1.srf      test_mol_2.srf 

- PDB files with the average surface atomic potential in the temperature factor
field for chain(s) A, chain(s) B and complex
test_mol_1.srfatpot test_mol_2.srfatpot	test.srfatpot

- pairs of atomic charges in contact followed by Pearson correlation coefficient and sum of products
test.crg_pair 

- pairs of potentials of surface points in contact followed by Pearson correlation coefficient and sum of products 
test.srf_pot_pair 

- files generated as input for NanoShaper (or msms):
coordinates and radius for chain(s) A, chain(s) B and complex
test_ns_mol_1.xyzr  test_ns_mol_2.xyzr  test_ns.xyzr
and parameters files (only for NanoShaper) for chain(s) A, chain(s) B 
and complex
test_ns_mol_1.prm  test_ns_mol_2.prm  test_ns.prm

-files generated by NanoShaper (or msms) with surface areas (only for 
NanoShaper), faces and vertices
for chain(s) A, chain(s) B and complex:
test_ns.area  test_ns_mol_1.area  test_ns_mol_2.area
test_ns.face  test_ns_mol_1.face  test_ns_mol_2.face
test_ns_mol_1.vert  test_ns_mol_2.vert  test_ns.vert

* USAGE

To see the available options just run

> bluues_cplx 

This outputs the list of all mandatory (pqr file, output file basename, two strings with the interacting chains) and non-mandatory options:

> Usage:
bluues2_cplx filename.pqr basename chain(s)_1 chain(s)_2 [Options]

Options:

-lite (ouput only summary file)

-ns file_basename (base file name for NanoShaper)

-rpns (read parameter file for NanoShaper instead of generating it)

-m file_basename (base file name for msms)

-pa x (x is the area per point on SES in A^2, 0.1 default)

-p x (use a probe radius for surfacing of x, 1.5 A default)

-tcr x (use a test charge radius of x, 0.7 A default)

-mr x (minimum radius for surfacing of x, 1.0 A default)

-s x (use a salt radius of x, 2.0 A default)

-pd x (inner dielectric constant, 4.0 default)

-sd x (outer dielectric constant, 78.54 default)

-kp x (factor for Still formula, 4 default)

-i x (ionic strength (M), 0.15 M default)

-t x (temperature, 298.15 K default)

-c x (cutoff for GBR6 calculation), 20.0 A default

-cs x (cutoff short for defining contacts between surfaces, 1.0 A default)

-g x (surface tension coefficient, 0.12 kJ/(A^2 mol) default)

-srf (output surface points, potential, atom n. and normal vectors)

-srfpot (output atomic and surface potential)

Either the options -ns or -m followed by a base filename should be given in order to compute the solvent excluded surface required for GB radii computation.
In the absence of one of the latter two alternative options, the program will use an internal approximation for computing GB radii, which is not guaranteed to be as accurate. Surface quantities will not be computed and the corresponding files will be empty.

-ns requires NanoShaper to be in the path
-m requires msms to be in the path

For large complexes the surface point density may require large computational and memory resources. In such cases the default value of area per point on SES (0.1 A^2) should be raised with the option -pa, e.g. -pa 0.5.

-cs followed by a distance sets the distance at which surface points on different molecules are considered in contact. The default value is 1 A.

Other options are shortly described above.
